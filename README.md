# å—é¨“æ ¡èª¿æŸ»ã‚¢ãƒ—ãƒª (Preferred School Survey System)

[![Version](https://img.shields.io/badge/version-2.4.0-blue.svg)](./VERSION_CHANGES.md)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](https://opensource.org/licenses/MIT)
[![Platform](https://img.shields.io/badge/platform-Google%20Apps%20Script-4285F4.svg)](https://developers.google.com/apps-script)

Google Apps Script (GAS) ã¨ Google ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ãŸã€**å—é¨“æ ¡èª¿æŸ»ãŠã‚ˆã³èª¿æŸ»æ›¸ç™ºè¡Œé¡˜ä½œæˆã‚·ã‚¹ãƒ†ãƒ **ã§ã™ã€‚

---

## ğŸ“– ç›®æ¬¡

- [æ¦‚è¦](#æ¦‚è¦)
- [v2.0.0 æ–°æ©Ÿèƒ½ãƒã‚¤ãƒ©ã‚¤ãƒˆ](#v200-æ–°æ©Ÿèƒ½ãƒã‚¤ãƒ©ã‚¤ãƒˆ)
- [æ©Ÿèƒ½ä¸€è¦§](#æ©Ÿèƒ½ä¸€è¦§)
- [ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶](#ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶)
- [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †)
- [ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ](#ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ)
- [ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](#ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)
- [ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](#ãƒ©ã‚¤ã‚»ãƒ³ã‚¹)

---

## æ¦‚è¦

ç”Ÿå¾’ãŒè‡ªèº«ã®å—é¨“äºˆå®šæ ¡ã‚„åˆå¦çµæœã‚’å…¥åŠ›ã—ã€æ•™å“¡ãŒãã®çŠ¶æ³ã‚’ä¸€å…ƒç®¡ç†ã™ã‚‹ãŸã‚ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

**ä¸»ãªç‰¹å¾´:**

- ğŸ“± **ãƒãƒ«ãƒãƒ‡ãƒã‚¤ã‚¹å¯¾å¿œ** - PCã€ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§å¿«é©æ“ä½œ
- ğŸŒ™ **ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰** - OSã®è¨­å®šã«é€£å‹•ã—ãŸè‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ
- ğŸ” **å¤§å­¦æ¤œç´¢æ©Ÿèƒ½** - Benesseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¯¾å¿œã®ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ã‚µãƒ¼ãƒ
- ğŸ“„ **PDFè‡ªå‹•ç™ºè¡Œ** - èª¿æŸ»æ›¸äº¤ä»˜é¡˜ã‚’ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¡ãƒ¼ãƒ«é€ä¿¡
- ğŸ”’ **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡** - ç”Ÿå¾’ãƒ»æ•™å“¡ãƒ»ç®¡ç†è€…ã®æ¨©é™ç®¡ç†

---

## âœ¨ v2.4.0 æ–°æ©Ÿèƒ½ãƒã‚¤ãƒ©ã‚¤ãƒˆ

> **2025å¹´12æœˆãƒªãƒªãƒ¼ã‚¹** - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ä¿¡é ¼æ€§ã‚’å¤§å¹…ã«å¼·åŒ–ï¼

| æ”¹å–„é …ç›® | è©³ç´° |
|:---|:---|
| ğŸ“¦ **åœ§ç¸®è»¢é€** | å¤§å­¦ãƒ‡ãƒ¼ã‚¿ã®gzipåœ§ç¸®+Base64è»¢é€ã§é€šä¿¡åŠ¹ç‡åŒ– |
| ğŸ”„ **ã‚·ãƒªã‚¢ãƒ«ç®¡ç†** | å¤§å­¦ãƒ‡ãƒ¼ã‚¿ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚·ãƒªã‚¢ãƒ«ç•ªå·ã«ã‚ˆã‚‹è‡ªå‹•æ›´æ–° |
| ğŸ” **ãƒªãƒˆãƒ©ã‚¤å‡¦ç†** | Exponential Backoffã«ã‚ˆã‚‹è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ |
| âš¡ **å³æ™‚åæ˜ ** | ã‚·ãƒ¼ãƒˆç·¨é›†æ™‚ã®ã‚µãƒ¼ãƒãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥è‡ªå‹•æ›´æ–° |
| ğŸ—‘ï¸ **è‡ªå‹•å‰Šé™¤** | è«–ç†å‰Šé™¤ãƒ¬ã‚³ãƒ¼ãƒ‰ã®å®šæœŸçš„å®Œå…¨å‰Šé™¤ |
| ğŸ”¥ **ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—** | 3æ™‚é–“ã”ã¨ã®ã‚µãƒ¼ãƒãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥è‡ªå‹•æ›´æ–° |
| ğŸ’¾ **ã‚­ãƒ£ãƒƒã‚·ãƒ¥** | å¤§å­¦ãƒ‡ãƒ¼ã‚¿(Client)ã¨è¨­å®šãƒ»ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿(Server)ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| ğŸ›¡ï¸ **å …ç‰¢æ€§** | ãƒ‡ãƒ¼ã‚¿å‹ãƒ»æ¯”è¼ƒæ¼”ç®—å­ã®å³æ ¼åŒ–ã¨ä¸æ•´åˆãƒã‚°ã®ä¿®æ­£ (v2.2.0) |

è©³ã—ãã¯ [VERSION_CHANGES.md](./VERSION_CHANGES.md) ã‚’ã”è¦§ãã ã•ã„ã€‚

---

## æ©Ÿèƒ½ä¸€è¦§

### ğŸ‘¨â€ğŸ“ ç”Ÿå¾’ç”¨æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|:---|:---|
| å—é¨“æ ¡å…¥åŠ› | å¿—æœ›å¤§å­¦ã€å­¦éƒ¨ã€è©¦é¨“å½¢æ…‹ã€åˆå¦çµæœã€é€²å­¦å…ˆã‚’å…¥åŠ›ãƒ»ä¿å­˜ |
| å¤§å­¦æ¤œç´¢ | ã‚³ãƒ¼ãƒ‰ã¾ãŸã¯åç§°ã§ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ã‚µãƒ¼ãƒ |
| èª¿æŸ»æ›¸äº¤ä»˜é¡˜ | å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãPDFã‚’ä½œæˆã—ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡ |

### ğŸ‘¨â€ğŸ« æ•™å“¡ç”¨æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|:---|:---|
| ç”Ÿå¾’ãƒ‡ãƒ¼ã‚¿é–²è¦§ | ã‚¯ãƒ©ã‚¹ãƒ»ç•ªå·ã‚’é¸æŠã—ã¦å…¥åŠ›çŠ¶æ³ã‚’ç¢ºèª |
| ä»£ç†å…¥åŠ› | å¿…è¦ã«å¿œã˜ã¦ç”Ÿå¾’ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç·¨é›† |

### âš™ï¸ ç®¡ç†è€…ç”¨æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|:---|:---|
| ãƒã‚¹ã‚¿ç®¡ç† | ç”Ÿå¾’ãƒ»è·å“¡ãƒ»å¤§å­¦ãƒ»é¸æŠè‚¢ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç† |
| è¨­å®šå¤‰æ›´ | ã‚¿ã‚¤ãƒˆãƒ«ã€å…¥åŠ›è¨±å¯æœŸé–“ã€ãƒ¡ãƒ¼ãƒ«æ–‡é¢ã®åˆ¶å¾¡ |
| ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ | æ ¡å†…DBç”¨ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ› |
| Benesseã‚¤ãƒ³ãƒãƒ¼ãƒˆ | Benesseå½¢å¼å¤§å­¦ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ‹¬å–ã‚Šè¾¼ã¿ |

---

## ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

### å¿…é ˆè¦ä»¶

- âœ… **Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** (Google Workspace æ¨å¥¨)
- âœ… **Google Chrome** (æœ€æ–°ç‰ˆ)

### æ¨å¥¨ç’°å¢ƒ

- Google Workspace for Education
- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ç·¨é›†æ¨©é™

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®æº–å‚™

ä»¥ä¸‹ã®ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼ˆ**åç§°å¤‰æ›´ä¸å¯**ï¼‰:

| ã‚·ãƒ¼ãƒˆå | ç”¨é€” |
|:---|:---|
| `å­¦ç±ãƒ‡ãƒ¼ã‚¿` | ç”Ÿå¾’ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€æ°åã€ã‚¯ãƒ©ã‚¹ãªã© |
| `è·å“¡ãƒ‡ãƒ¼ã‚¿` | æ•™å“¡ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€æ°å |
| `å—é¨“æ ¡DB` | å…¥åŠ›ã•ã‚ŒãŸå—é¨“ãƒ‡ãƒ¼ã‚¿ã®è“„ç©å…ˆ |
| `å¤§å­¦ãƒ‡ãƒ¼ã‚¿` | å¤§å­¦ã‚³ãƒ¼ãƒ‰ãƒã‚¹ã‚¿ |
| `è©¦é¨“å½¢æ…‹` | ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³é¸æŠè‚¢ |
| `åˆå¦é¸æŠè‚¢` | ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³é¸æŠè‚¢ |
| `å—é¨“å½¢æ…‹é¸æŠè‚¢` | ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³é¸æŠè‚¢ |
| `è¨­å®š` | ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®è¨­å®š |
| `èª¿æŸ»æ›¸äº¤ä»˜é¡˜` | PDFå‡ºåŠ›ç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ |
| `æ ¡å†…DBç”¨` | ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆç”¨ä¸€æ™‚ã‚·ãƒ¼ãƒˆ |

### 2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

1. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã® **æ‹¡å¼µæ©Ÿèƒ½** > **Apps Script** ã‚’é–‹ã
2. å„ãƒ•ã‚¡ã‚¤ãƒ« (`main.js`, `index.html`, `css.html`, `script.html`) ã‚’ã‚³ãƒ”ãƒ¼
3. **ãƒ‡ãƒ—ãƒ­ã‚¤** > **æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤** ã‚’é¸æŠ
4. ä»¥ä¸‹ã®è¨­å®šã§ãƒ‡ãƒ—ãƒ­ã‚¤:

   | é …ç›® | è¨­å®šå€¤ |
   |:---|:---|
   | ç¨®é¡ | ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª |
   | æ¬¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å®Ÿè¡Œ | `ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼` |
   | ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ | `ãƒ‰ãƒ¡ã‚¤ãƒ³å†…ã®å…¨å“¡` ã¾ãŸã¯ `å…¨å“¡` |

5. ç™ºè¡Œã•ã‚ŒãŸURLã‚’å…±æœ‰

### 3. Benesseãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

> [!IMPORTANT]
> Benesseã®å¤§å­¦ãƒ‡ãƒ¼ã‚¿CSVãƒ•ã‚¡ã‚¤ãƒ«ã¯ **ShiftJIS** ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‰ã« **UTF-8** ã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚

**å¤‰æ›æ‰‹é †:**

1. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ¡ãƒ¢å¸³ãªã©ã§é–‹ã
2. **åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜** > **ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰: UTF-8** ã‚’é¸æŠã—ã¦ä¿å­˜
3. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¾Œã€`importUniversityData()` ã‚’å®Ÿè¡Œ

---

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
juken-survey/
â”œâ”€â”€ main.js              # ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ (GAS)
â”œâ”€â”€ index.html           # ãƒ¡ã‚¤ãƒ³ç”»é¢ã®HTMLæ§‹é€ 
â”œâ”€â”€ css.html             # ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ (CSS)
â”œâ”€â”€ script.html          # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ (JavaScript)
â”œâ”€â”€ appsscript.json      # GASãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ README.md            # æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ PROGRAM_SPECIFICATION.md  # ãƒ—ãƒ­ã‚°ãƒ©ãƒ è©³ç´°ä»•æ§˜
â”œâ”€â”€ TEACHER_MANUAL.md    # æ•™å“¡å‘ã‘æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«
â”œâ”€â”€ STUDENT_MANUAL.md    # ç”Ÿå¾’å‘ã‘æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«
â””â”€â”€ VERSION_CHANGES.md   # ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´å±¥æ­´
```

---

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å¯¾è±¡ | å†…å®¹ |
|:---|:---|:---|
| [PROGRAM_SPECIFICATION.md](./PROGRAM_SPECIFICATION.md) | é–‹ç™ºè€… | ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆãƒ»APIä»•æ§˜ |
| [TEACHER_MANUAL.md](./TEACHER_MANUAL.md) | æ•™å“¡ãƒ»ç®¡ç†è€… | æ“ä½œæ‰‹é †ãƒ»ç®¡ç†æ©Ÿèƒ½ã®ä½¿ã„æ–¹ |
| [STUDENT_MANUAL.md](./STUDENT_MANUAL.md) | ç”Ÿå¾’ | å—é¨“æ ¡å…¥åŠ›ãƒ»èª¿æŸ»æ›¸ç™ºè¡Œã®æ‰‹é † |
| [VERSION_CHANGES.md](./VERSION_CHANGES.md) | å…¨å“¡ | v2.0.0ã®å¤‰æ›´ç‚¹ä¸€è¦§ |

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

[MIT License](https://opensource.org/licenses/MIT)

```
Copyright (c) 2025 Shigeru Suzuki

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
```

---

<div align="center">

**Made for Education**

</div>
